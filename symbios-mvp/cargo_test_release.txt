cargo.exe : warning: virtual workspace defaulting to `resolver = "1"` despite one or more workspace members being on edition 2
021 which implies `resolver = "2"`
строка:1 знак:183
+ ... $env:Path"; & "C:\Users\$env:USERNAME\.cargo\bin\cargo.exe" test --re ...
+                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (warning: virtua...resolver = "2"`:String) [], RemoteException
    + FullyQualifiedErrorId : NativeCommandError
 
note: to keep the current resolver, specify `workspace.resolver = "1"` in the workspace root's manifest
note: to use the edition 2021 resolver, specify `workspace.resolver = "2"` in the workspace root's manifest
note: for more details see https://doc.rust-lang.org/cargo/reference/resolver.html#resolver-versions
   Compiling crossbeam-utils v0.8.21
   Compiling rayon-core v1.13.0
   Compiling half v2.6.0
   Compiling ciborium-io v0.2.2
   Compiling clap_lex v0.7.5
   Compiling anstyle v1.0.11
   Compiling plotters-backend v0.3.7
   Compiling same-file v1.0.6
   Compiling clap_builder v4.5.47
   Compiling ciborium-ll v0.2.2
   Compiling plotters-svg v0.3.7
   Compiling itertools v0.10.5
   Compiling async-stream-impl v0.3.6
   Compiling cast v0.3.0
   Compiling bit-vec v0.8.0
   Compiling quick-error v1.2.3
   Compiling wait-timeout v0.2.1
   Compiling ciborium v0.2.2
   Compiling bit-set v0.8.0
   Compiling rusty-fork v0.3.0
   Compiling plotters v0.3.7
   Compiling crossbeam-epoch v0.9.18
   Compiling async-stream v0.3.6
   Compiling crossbeam-deque v0.8.6
   Compiling walkdir v2.5.0
   Compiling criterion-plot v0.5.0
   Compiling tinytemplate v1.2.1
   Compiling clap v4.5.47
   Compiling rayon v1.11.0
   Compiling rand_xorshift v0.4.0
   Compiling tokio-stream v0.1.17
   Compiling unarray v0.1.4
   Compiling oorandom v11.1.5
   Compiling bitflags v2.9.4
   Compiling anes v0.1.6
   Compiling proptest v1.8.0
   Compiling tokio-test v0.4.4
   Compiling symbios-mvp v0.1.0 (D:\╨┐╤А╨╛╨╡╨║╤В╤Л\symbios\symbios-mvp)
warning: unused imports: `Rng` and `rngs::OsRng`
 --> symbios-mvp\src\types.rs:9:12
  |
9 | use rand::{Rng, rngs::OsRng};
  |            ^^^  ^^^^^^^^^^^
  |
  = note: `#[warn(unused_imports)]` on by default

warning: unused import: `std::collections::HashMap`
 --> symbios-mvp\src\consensus.rs:1:5
  |
1 | use std::collections::HashMap;
  |     ^^^^^^^^^^^^^^^^^^^^^^^^^

warning: unused import: `BTreeMap`
 --> symbios-mvp\src\hotstuff_consensus.rs:8:52
  |
8 | use std::collections::{HashMap, HashSet, VecDeque, BTreeMap};
  |                                                    ^^^^^^^^

warning: unused imports: `Instant`, `SystemTime`, and `UNIX_EPOCH`
  --> symbios-mvp\src\hotstuff_consensus.rs:10:27
   |
10 | use std::time::{Duration, Instant, SystemTime, UNIX_EPOCH};
   |                           ^^^^^^^  ^^^^^^^^^^  ^^^^^^^^^^

warning: unused imports: `broadcast` and `oneshot`
  --> symbios-mvp\src\hotstuff_consensus.rs:12:48
   |
12 | use tokio::sync::{RwLock as AsyncRwLock, mpsc, oneshot, broadcast};
   |                                                ^^^^^^^  ^^^^^^^^^

warning: unused import: `futures::future::join_all`
  --> symbios-mvp\src\hotstuff_consensus.rs:13:5
   |
13 | use futures::future::join_all;
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^

warning: unused imports: `BlockHeight`, `BlockchainError`, `BlockchainResult`, and `ValidatorInfo`
  --> symbios-mvp\src\hotstuff_consensus.rs:14:69
   |
14 | ... PublicKey, PrivateKey, BlockHeight, Timestamp, ValidatorSet, ValidatorInfo, BlockchainError, BlockchainResult};
   |                            ^^^^^^^^^^^                           ^^^^^^^^^^^^^  ^^^^^^^^^^^^^^^  ^^^^^^^^^^^^^^^^

warning: unused import: `StateResult`
  --> symbios-mvp\src\hotstuff_consensus.rs:15:42
   |
15 | use crate::state_machine::{StateMachine, StateResult};
   |                                          ^^^^^^^^^^^

warning: unused imports: `Amount` and `Nonce`
  --> symbios-mvp\src\state_machine.rs:10:66
   |
10 | use crate::types::{Transaction, Block, PublicKey, Hash, Address, Amount, Nonce};
   |                                                                  ^^^^^^  ^^^^^

warning: unused imports: `Deserialize` and `Serialize`
 --> symbios-mvp\src\storage.rs:1:13
  |
1 | use serde::{Deserialize, Serialize};
  |             ^^^^^^^^^^^  ^^^^^^^^^

warning: unused import: `VecDeque`
 --> symbios-mvp\src\efficient_execution.rs:7:42
  |
7 | use std::collections::{HashMap, HashSet, VecDeque};
  |                                          ^^^^^^^^

warning: unused imports: `Hash`, `PrivateKey`, `PublicKey`, and `Signature`
 --> symbios-mvp\src\pqcrypto.rs:6:20
  |
6 | use crate::types::{PublicKey, PrivateKey, Signature, Hash};
  |                    ^^^^^^^^^  ^^^^^^^^^^  ^^^^^^^^^  ^^^^

error[E0599]: no variant or associated item named `LockPoisoned` found for enum `BlockchainError` in the current scope
   --> symbios-mvp\src\hotstuff_consensus.rs:253:107
    |
253 |         let mut proposed_blocks = self.proposed_blocks.write().map_err(|_| crate::types::BlockchainError::LockPoisoned)?
;
    |                                                                                                           ^^^^^^^^^^^^ v
ariant or associated item not found in `BlockchainError`
    |
   ::: symbios-mvp\src\types.rs:510:1
    |
510 | pub enum BlockchainError {
    | ------------------------ variant or associated item `LockPoisoned` not found for this enum

error[E0599]: no variant or associated item named `LockPoisoned` found for enum `BlockchainError` in the current scope
   --> symbios-mvp\src\hotstuff_consensus.rs:275:97
    |
275 |         let mut buffer = self.message_buffer.write().map_err(|_| crate::types::BlockchainError::LockPoisoned)?;
    |                                                                                                 ^^^^^^^^^^^^ variant or 
associated item not found in `BlockchainError`
    |
   ::: symbios-mvp\src\types.rs:510:1
    |
510 | pub enum BlockchainError {
    | ------------------------ variant or associated item `LockPoisoned` not found for this enum

error[E0599]: no variant or associated item named `LockPoisoned` found for enum `BlockchainError` in the current scope
   --> symbios-mvp\src\hotstuff_consensus.rs:335:107
    |
335 |         let mut proposed_blocks = self.proposed_blocks.write().map_err(|_| crate::types::BlockchainError::LockPoisoned)?
;
    |                                                                                                           ^^^^^^^^^^^^ v
ariant or associated item not found in `BlockchainError`
    |
   ::: symbios-mvp\src\types.rs:510:1
    |
510 | pub enum BlockchainError {
    | ------------------------ variant or associated item `LockPoisoned` not found for this enum

error[E0599]: no variant or associated item named `LockPoisoned` found for enum `BlockchainError` in the current scope
   --> symbios-mvp\src\hotstuff_consensus.rs:362:99
    |
362 |         let mut vote_buffer = self.vote_buffer.write().map_err(|_| crate::types::BlockchainError::LockPoisoned)?;
    |                                                                                                   ^^^^^^^^^^^^ variant o
r associated item not found in `BlockchainError`
    |
   ::: symbios-mvp\src\types.rs:510:1
    |
510 | pub enum BlockchainError {
    | ------------------------ variant or associated item `LockPoisoned` not found for this enum

error[E0599]: no variant or associated item named `LockPoisoned` found for enum `BlockchainError` in the current scope
   --> symbios-mvp\src\hotstuff_consensus.rs:417:94
    |
417 |         let vote_buffer = self.vote_buffer.read().map_err(|_| crate::types::BlockchainError::LockPoisoned)?;
    |                                                                                              ^^^^^^^^^^^^ variant or ass
ociated item not found in `BlockchainError`
    |
   ::: symbios-mvp\src\types.rs:510:1
    |
510 | pub enum BlockchainError {
    | ------------------------ variant or associated item `LockPoisoned` not found for this enum

error[E0599]: no variant or associated item named `LockPoisoned` found for enum `BlockchainError` in the current scope
   --> symbios-mvp\src\hotstuff_consensus.rs:450:99
    |
450 |         let mut safety_data = self.safety_data.write().map_err(|_| crate::types::BlockchainError::LockPoisoned)?;
    |                                                                                                   ^^^^^^^^^^^^ variant o
r associated item not found in `BlockchainError`
    |
   ::: symbios-mvp\src\types.rs:510:1
    |
510 | pub enum BlockchainError {
    | ------------------------ variant or associated item `LockPoisoned` not found for this enum

warning: unused variable: `sender`
   --> symbios-mvp\src\hotstuff_consensus.rs:462:94
    |
462 | ...Hash, qc: QuorumCertificate, sender: PublicKey) -> Result<(), Box<dyn std::error::Error>> {
    |                                 ^^^^^^ help: if this is intentional, prefix it with an underscore: `_sender`
    |
    = note: `#[warn(unused_variables)]` on by default

error[E0599]: no variant or associated item named `LockPoisoned` found for enum `BlockchainError` in the current scope
   --> symbios-mvp\src\hotstuff_consensus.rs:482:102
    |
482 |         let proposed_blocks = self.proposed_blocks.read().map_err(|_| crate::types::BlockchainError::LockPoisoned)?;
    |                                                                                                      ^^^^^^^^^^^^ varian
t or associated item not found in `BlockchainError`
    |
   ::: symbios-mvp\src\types.rs:510:1
    |
510 | pub enum BlockchainError {
    | ------------------------ variant or associated item `LockPoisoned` not found for this enum

error[E0599]: no variant or associated item named `LockPoisoned` found for enum `BlockchainError` in the current scope
   --> symbios-mvp\src\hotstuff_consensus.rs:495:103
    |
495 |             let mut safety_data = self.safety_data.write().map_err(|_| crate::types::BlockchainError::LockPoisoned)?;
    |                                                                                                       ^^^^^^^^^^^^ varia
nt or associated item not found in `BlockchainError`
    |
   ::: symbios-mvp\src\types.rs:510:1
    |
510 | pub enum BlockchainError {
    | ------------------------ variant or associated item `LockPoisoned` not found for this enum

warning: unused variable: `view_number`
   --> symbios-mvp\src\hotstuff_consensus.rs:505:37
    |
505 |     async fn handle_new_view(&self, view_number: u64, justify: QuorumCertificate, sender: PublicKey) -> Result<(), Box<d
yn std::error::Er...
    |                                     ^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_view_numbe
r`

warning: unused variable: `sender`
   --> symbios-mvp\src\hotstuff_consensus.rs:505:83
    |
505 | ... justify: QuorumCertificate, sender: PublicKey) -> Result<(), Box<dyn std::error::Error>> {
    |                                 ^^^^^^ help: if this is intentional, prefix it with an underscore: `_sender`

error[E0599]: no variant or associated item named `LockPoisoned` found for enum `BlockchainError` in the current scope
   --> symbios-mvp\src\hotstuff_consensus.rs:537:98
    |
537 |         let validator_set = self.validator_set.read().map_err(|_| crate::types::BlockchainError::LockPoisoned)?;
    |                                                                                                  ^^^^^^^^^^^^ variant or
 associated item not found in `BlockchainError`
    |
   ::: symbios-mvp\src\types.rs:510:1
    |
510 | pub enum BlockchainError {
    | ------------------------ variant or associated item `LockPoisoned` not found for this enum

error[E0599]: no variant or associated item named `LockPoisoned` found for enum `BlockchainError` in the current scope
   --> symbios-mvp\src\hotstuff_consensus.rs:553:98
    |
553 |         let validator_set = self.validator_set.read().map_err(|_| crate::types::BlockchainError::LockPoisoned)?;
    |                                                                                                  ^^^^^^^^^^^^ variant or
 associated item not found in `BlockchainError`
    |
   ::: symbios-mvp\src\types.rs:510:1
    |
510 | pub enum BlockchainError {
    | ------------------------ variant or associated item `LockPoisoned` not found for this enum

error[E0599]: no variant or associated item named `LockPoisoned` found for enum `BlockchainError` in the current scope
   --> symbios-mvp\src\hotstuff_consensus.rs:571:98
    |
571 |         let validator_set = self.validator_set.read().map_err(|_| crate::types::BlockchainError::LockPoisoned)?;
    |                                                                                                  ^^^^^^^^^^^^ variant or
 associated item not found in `BlockchainError`
    |
   ::: symbios-mvp\src\types.rs:510:1
    |
510 | pub enum BlockchainError {
    | ------------------------ variant or associated item `LockPoisoned` not found for this enum

warning: unused variable: `view_number`
   --> symbios-mvp\src\hotstuff_consensus.rs:583:34
    |
583 |     async fn create_block(&self, view_number: u64, transactions: Vec<Transaction>, justify_qc: QuorumCertificate) -> Res
ult<Block, Box<dy...
    |                                  ^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_view_number`

warning: unused variable: `transactions`
   --> symbios-mvp\src\hotstuff_consensus.rs:583:52
    |
583 | ...elf, view_number: u64, transactions: Vec<Transaction>, justify_qc: QuorumCertificate) -> Result<Block, Box<dyn std::e
rror::Error>> {
    |                           ^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_transactions`

warning: unused variable: `justify_qc`
   --> symbios-mvp\src\hotstuff_consensus.rs:583:84
    |
583 | ...tions: Vec<Transaction>, justify_qc: QuorumCertificate) -> Result<Block, Box<dyn std::error::Error>> {
    |                             ^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_justify_qc`

warning: unused variable: `message`
   --> symbios-mvp\src\hotstuff_consensus.rs:598:38
    |
598 |     async fn validate_message(&self, message: &HotStuffMessage) -> Result<(), Box<dyn std::error::Error>> {
    |                                      ^^^^^^^ help: if this is intentional, prefix it with an underscore: `_message`

error[E0596]: cannot borrow data in an `Arc` as mutable
   --> symbios-mvp\src\hotstuff_consensus.rs:615:29
    |
615 |             if let Err(e) = consensus.process_message(message).await {
    |                             ^^^^^^^^^ cannot borrow as mutable
    |
    = help: trait `DerefMut` is required to modify through a dereference, but it is not implemented for `Arc<HotStuffConsensus
<S>>`

warning: unused variable: `tc`
   --> symbios-mvp\src\hotstuff_consensus.rs:639:13
    |
639 |         let tc = TimeoutCertificate {
    |             ^^ help: if this is intentional, prefix it with an underscore: `_tc`

error[E0599]: no variant or associated item named `LockPoisoned` found for enum `BlockchainError` in the current scope
   --> symbios-mvp\src\hotstuff_consensus.rs:685:102
    |
685 |         let proposed_blocks = self.proposed_blocks.read().map_err(|_| crate::types::BlockchainError::LockPoisoned)?;
    |                                                                                                      ^^^^^^^^^^^^ varian
t or associated item not found in `BlockchainError`
    |
   ::: symbios-mvp\src\types.rs:510:1
    |
510 | pub enum BlockchainError {
    | ------------------------ variant or associated item `LockPoisoned` not found for this enum

warning: unused variable: `commit_msg`
   --> symbios-mvp\src\lightweight_consensus.rs:218:17
    |
218 |             let commit_msg = ConsensusMessage::Commit { block_hash, round };
    |                 ^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_commit_msg`

warning: unused import: `futures::TryFutureExt`
 --> symbios-mvp\src\state_machine.rs:9:5
  |
9 | use futures::TryFutureExt;
  |     ^^^^^^^^^^^^^^^^^^^^^

   Compiling criterion v0.5.1
warning: unused variable: `parents`
   --> symbios-mvp\src\dag_mempool.rs:497:9
    |
497 |         parents: Vec<Hash>,
    |         ^^^^^^^ help: if this is intentional, prefix it with an underscore: `_parents`

warning: unused variable: `owner`
  --> symbios-mvp\src\state_machine.rs:52:16
   |
52 |     pub fn new(owner: PublicKey) -> Self {
   |                ^^^^^ help: if this is intentional, prefix it with an underscore: `_owner`

warning: unused variable: `processed_txs`
   --> symbios-mvp\src\state_machine.rs:221:17
    |
221 |         let mut processed_txs = self.processed_txs.write().map_err(|_| StateError::LockPoisoned)?;
    |                 ^^^^^^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_processed_txs`

warning: variable does not need to be mutable
   --> symbios-mvp\src\state_machine.rs:221:13
    |
221 |         let mut processed_txs = self.processed_txs.write().map_err(|_| StateError::LockPoisoned)?;
    |             ----^^^^^^^^^^^^^
    |             |
    |             help: remove this `mut`
    |
    = note: `#[warn(unused_mut)]` on by default

warning: unused variable: `mempool`
   --> symbios-mvp\src\lightweight_consensus.rs:275:9
    |
275 |         mempool: &mut dyn MempoolTrait,
    |         ^^^^^^^ help: if this is intentional, prefix it with an underscore: `_mempool`

error: future cannot be sent between threads safely
   --> symbios-mvp\src\minimal_storage.rs:321:5
    |
321 |     async fn get_block_by_height(&self, height: u64) -> Result<Option<Block>, Box<dyn std::error::Error>> {
    |     ^^^^^ future created by async block is not `Send`
    |
    = help: the trait `std::marker::Send` is not implemented for `dyn StdError`
note: future is not `Send` as this value is used across an await
   --> symbios-mvp\src\minimal_storage.rs:326:45
    |
323 |         match self.retrieve_entry(&height_key).await? {
    |               --------------------------------------- has type `ControlFlow<Result<Infallible, Box<dyn StdError>>, std::
option::Option<StorageEntry>>` which is not `Send`
...
326 |                 self.get_block(&block_hash).await
    |                                             ^^^^^ await occurs here, with `self.retrieve_entry(&height_key).await?` mayb
e used later
    = note: required for the cast from `Pin<Box<{async block@symbios-mvp\src\minimal_storage.rs:321:5: 321:10}>>` to `Pin<Box<
dyn Future<Output = Result<Option<Block>, Box<...>>> + Send>>`
    = note: the full name for the type has been written to 'D:\╨┐╤А╨╛╨╡╨║╤В╤Л\symbios\target\release\deps\symbios_mvp-07de7fde
348d4a89.long-type-3353871636359280872.txt'
    = note: consider using `--verbose` to print the full type name to the console

error: future cannot be sent between threads safely
   --> symbios-mvp\src\minimal_storage.rs:332:5
    |
332 |     async fn get_latest_block(&self) -> Result<Option<Block>, Box<dyn std::error::Error>> {
    |     ^^^^^ future created by async block is not `Send`
    |
    = help: the trait `std::marker::Send` is not implemented for `dyn StdError`
note: future is not `Send` as this value is used across an await
   --> symbios-mvp\src\minimal_storage.rs:337:45
    |
334 |         match self.retrieve_entry(latest_key).await? {
    |               -------------------------------------- has type `ControlFlow<Result<Infallible, Box<dyn StdError>>, std::o
ption::Option<StorageEntry>>` which is not `Send`
...
337 |                 self.get_block(&block_hash).await
    |                                             ^^^^^ await occurs here, with `self.retrieve_entry(latest_key).await?` maybe
 used later
    = note: required for the cast from `Pin<Box<{async block@symbios-mvp\src\minimal_storage.rs:332:5: 332:10}>>` to `Pin<Box<
dyn Future<Output = Result<Option<Block>, Box<...>>> + Send>>`
    = note: the full name for the type has been written to 'D:\╨┐╤А╨╛╨╡╨║╤В╤Л\symbios\target\release\deps\symbios_mvp-07de7fde
348d4a89.long-type-3353871636359280872.txt'
    = note: consider using `--verbose` to print the full type name to the console

Some errors have detailed explanations: E0596, E0599.
For more information about an error, try `rustc --explain E0596`.
warning: `symbios-mvp` (lib) generated 27 warnings
error: could not compile `symbios-mvp` (lib) due to 15 previous errors; 27 warnings emitted
warning: build failed, waiting for other jobs to finish...
